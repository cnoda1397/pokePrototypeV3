<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Reset</title>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-database.js"></script>


    <script>
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      var firebaseConfig = {
        apiKey: "AIzaSyBGZ-aJ6nvQv9sd62KDgVN-_MCwhjKFeoY",
        authDomain: "testdb-9b696.firebaseapp.com",
        databaseURL: "https://testdb-9b696-default-rtdb.firebaseio.com",
        projectId: "testdb-9b696",
        storageBucket: "testdb-9b696.appspot.com",
        messagingSenderId: "491392582429",
        appId: "1:491392582429:web:8010499236e2b929e8d7f4",
        measurementId: "G-02MY9KHXY8"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      //firebase.analytics();
    </script>
    <script src = "pokedex.js" defer></script>
    <script>
      function resetAsh(){
        var query = firebase.database().ref("Ash").orderByKey();
        query.once("value").then(function(snapshot) {
            snapshot.forEach(function(childSnapshot) {
                //key = dex id
                var key = childSnapshot.key;
                //childdata = {caught}, {level}
                var childData = childSnapshot.val();
                Object.keys(childData).forEach(key => {
                  if(key !== "_Level"){
                    childData[key] = 1;
                    document.getElementById("output").innerHTML = childData[key];
                  }
                })
                childSnapshot.ref.update(childData);
                
            });
        });
    }
    function changeGen(){
      const genLimit = 2;
      var dbRef = firebase.database().ref('/Admin/Generation');
      dbRef.transaction(gen =>{
        return (gen % genLimit) + 1;
      })
    }
    </script>
  </head>
  <body>
    
    <p id="dex"></p>
    <button id="reset" onclick="resetAsh()">Reset Ash</button>
    <p id = "output"></p>
    <button id="gen" onclick="changeGen()">Change Generation</button>

  </body>
</html>
